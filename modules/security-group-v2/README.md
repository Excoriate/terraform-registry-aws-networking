<!-- BEGIN_TF_DOCS -->
# ‚òÅÔ∏è AWS Security Group Module
## Description
This module allows for the streamlined creation and management of AWS Security Groups within a specified VPC. It supports detailed customization for both ingress and egress rules, ensuring a high degree of flexibility for network traffic management.

Key Features:
* üöÄ Creation of a security group within a specified VPC.
* üõ°Ô∏è Customizable ingress and egress rules to control traffic flow.
* üîß Optional descriptions for security groups and rules for easy management.
* üåê Support for both IPv4 and IPv6 CIDR blocks.
* üîç Automatic security group self-referencing capability.

Learn more about AWS Security Groups in the [AWS Documentation](https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html). For Terraform specifics, consult the [Terraform AWS Provider Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group).

---
## Usage Examples
For practical examples on how to use this module, refer to the following configurations:

- **Basic Security Group**: Setup without ingress or egress rules.
```hcl
module "basic_sg" {
  source  = "../"
  is_enabled = true
  security_group_config = {
    name        = "basic-sg"
    description = "Basic Security Group without rules"
    vpc_id      = "vpc-xxxxxx"
    ingress     = []
    egress      = []
  }
}
```

- **Security Group with Custom Rules**: Demonstrates adding custom ingress and egress rules.
```hcl
module "custom_sg" {
  source  = "../"
  is_enabled = true
  security_group_config = {
    name        = "custom-sg"
    description = "Security Group with custom rules"
    vpc_id      = "vpc-xxxxxx"
    ingress = [
      {
        description      = "Allow SSH"
        from_port        = 22
        to_port          = 22
        protocol         = "tcp"
        cidr_blocks      = ["0.0.0.0/0"]
      }
    ]
    egress = [
      {
        description      = "Allow all outbound"
        from_port        = 0
        to_port          = 0
        protocol         = "-1"
        cidr_blocks      = ["0.0.0.0/0"]
      }
    ]
  }
}
```

For more examples and module usage details, explore the [examples](../examples) directory.
## Example implementation (or recipe)
```hcl
  module "main_module" {
  source                = "../../../modules/security-group-v2"
  is_enabled            = var.is_enabled
  security_group_config = var.security_group_config
}
```
1. Complex configuration
```hcl
  security_group_config = {
  name        = "sg-complex"
  description = "Security Group with multiple rules"
  vpc_id      = "vpc-04eaef44d62c5b7a6"
  ingress     = [
    {
      description = "Allow SSH"
      from_port   = 22
      to_port     = 22
      protocol    = "tcp"
      cidr_blocks = ["0.0.0.0/0"]
    },
    {
      description = "Allow HTTP"
      from_port   = 80
      to_port     = 80
      protocol    = "tcp"
      cidr_blocks = ["0.0.0.0/0"]
    }
  ]
  egress = [
    {
      description = "Allow All Outbound Traffic"
      from_port   = 0
      to_port     = 0
      protocol    = "-1"
      cidr_blocks = ["0.0.0.0/0"]
    }
  ]
}

is_enabled = true
```

2. With self-referencing
```hcl
  security_group_config = {
  name        = "sg-self-ref"
  description = "Security Group with a self-referencing rule"
  vpc_id      = "vpc-04eaef44d62c5b7a6"
  ingress     = [
    {
      description = "Allow internal traffic"
      from_port   = 0
      to_port     = 0
      protocol    = "-1"
      self        = true
    }
  ]
  egress = [
    {
      description = "Allow outbound traffic to specific CIDR"
      from_port   = 0
      to_port     = 0
      protocol    = "-1"
      cidr_blocks = ["10.0.0.0/16"]
    }
  ]
}

is_enabled = true
```



---

## Auto-Generated Module Documentation
Below is the documentation generated by [terraform-docs](https://terraform-docs.io), covering providers, resources, requirements, inputs, and outputs.

## Providers

| Name | Version |
|------|---------|
| <a name="provider_aws"></a> [aws](#provider\_aws) | >= 4.48.0, < 5.0.0 |

## Modules

No modules.

## Resources

| Name | Type |
|------|------|
| [aws_security_group.this](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group) | resource |

## Requirements

| Name | Version |
|------|---------|
| <a name="requirement_terraform"></a> [terraform](#requirement\_terraform) | >= 1.7.0 |
| <a name="requirement_aws"></a> [aws](#requirement\_aws) | >= 4.48.0, < 5.0.0 |

## Inputs

| Name | Description | Type | Default | Required |
|------|-------------|------|---------|:--------:|
| <a name="input_is_enabled"></a> [is\_enabled](#input\_is\_enabled) | Whether this module will be created or not. Useful for stack-composite<br>modules that conditionally include resources provided by this module. | `bool` | `true` | no |
| <a name="input_security_group_config"></a> [security\_group\_config](#input\_security\_group\_config) | An object  representing the configuration for a security group, facilitating detailed control over ingress and egress rules.<br><br>- `name`: The name of the security group.<br>- `description`: Describes the security group (default: "Managed by Terraform").<br>- `vpc_id`: The VPC ID for the security group (See [AWS VPC Documentation](https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html)).<br><br>Each `ingress` and `egress` rule object can have the following attributes:<br><br>- `description`: Rule description (default: "Ingress Rule" or "Egress Rule").<br>- `from_port`: Starting port range or ICMP type number.<br>- `to_port`: Ending port range or ICMP code number.<br>- `protocol`: Protocol type (e.g., "tcp", "udp", "icmp", or "-1" for all).<br>- `cidr_blocks`: CIDR blocks allowed (default: empty).<br>- `ipv6_cidr_blocks`: IPv6 CIDR blocks allowed (default: empty).<br>- `prefix_list_ids`: Prefix list IDs for VPC endpoint access (default: empty).<br>- `security_groups`: Security group IDs allowed (default: empty).<br>- `self`: Apply the rule to the security group itself (default: false).<br><br>For more details on defining security groups with Terraform, refer to the [Terraform AWS Provider Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group). | <pre>object({<br>    name        = string<br>    description = optional(string, "Managed by Terraform")<br>    vpc_id      = string<br>    ingress     = optional(list(object({<br>      description      = optional(string, "Ingress Rule")<br>      from_port        = number<br>      to_port          = number<br>      protocol         = string<br>      cidr_blocks      = optional(list(string), [])<br>      ipv6_cidr_blocks = optional(list(string), [])<br>      prefix_list_ids  = optional(list(string), [])<br>      security_groups  = optional(list(string), [])<br>      self             = optional(bool, false)<br>    })), [])<br>    egress      = optional(list(object({<br>      description      = optional(string, "Egress Rule")<br>      from_port        = number<br>      to_port          = number<br>      protocol         = string<br>      cidr_blocks      = optional(list(string), [])<br>      ipv6_cidr_blocks = optional(list(string), [])<br>      prefix_list_ids  = optional(list(string), [])<br>      security_groups  = optional(list(string), [])<br>      self             = optional(bool, false)<br>    })), [])<br>  })</pre> | `null` | no |
| <a name="input_tags"></a> [tags](#input\_tags) | A map of tags to add to all resources. | `map(string)` | `{}` | no |

## Outputs

| Name | Description |
|------|-------------|
| <a name="output_is_enabled"></a> [is\_enabled](#output\_is\_enabled) | Whether the module is enabled or not. |
| <a name="output_security_group_arn"></a> [security\_group\_arn](#output\_security\_group\_arn) | The ARN of the security group created by the module. Returns an empty string if the module is not enabled or no security group is created. |
| <a name="output_security_group_description"></a> [security\_group\_description](#output\_security\_group\_description) | The description of the security group created by the module. Returns an empty string if the module is not enabled or no security group is created. |
| <a name="output_security_group_id"></a> [security\_group\_id](#output\_security\_group\_id) | The ID of the security group created by the module. Returns an empty string if the module is not enabled or no security group is created. |
| <a name="output_security_group_name"></a> [security\_group\_name](#output\_security\_group\_name) | The name of the security group created by the module. Returns an empty string if the module is not enabled or no security group is created. |
| <a name="output_security_group_vpc_id"></a> [security\_group\_vpc\_id](#output\_security\_group\_vpc\_id) | The VPC ID associated with the security group created by the module. Returns an empty string if the module is not enabled or no security group is created. |
| <a name="output_tags_set"></a> [tags\_set](#output\_tags\_set) | The tags set for the module. |
<!-- END_TF_DOCS -->